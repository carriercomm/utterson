#!/usr/bin/ksh
# generates an atomfeed and static html blog pages from
# posts/*.html files, containing the entry content of the posts, the
# filename is used as a title, the last modification time as
# lastupdate.
#
# TODO tags, blog search

. ${0%%/*}/utterson.cfg
. ${0%%/*}/utterson.lib

########### start processing #############

postslen=${#@}

# get timestamp of very last post for rss
TVARS[LASTUPDATED]="$(getRFCtime "${1}")"

#### MAIN LOOP STARTS HERE ####

runtpl atom header
# process posts
for entry; do
    tvarinit
    runtpl atom item
done

runtpl atom footer
